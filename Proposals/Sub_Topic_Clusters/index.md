=Sub-topic Clusters in WPD=

We have [[WPD:Implementation_Patterns/Templates#Topics.2C_Topic_Clusters.2C_See_Also|topic clusters]], which were designed to automatically generate a section of related pages in the See Also section. This feature allows an author to create associations between articles without the author having to know about (or where to find) the articles.

The current implementation works pretty well for API pages. For example, a high-level topic cluster pertains to a broad area of focus, like Off-line Storage, to which the [[apis/filesystem|FileSystem]], IndexedDB, AppCache, and StorageQuota APIs belong. But only the API Listing pages belong in this topic cluster, not their member API object child pages (i.e. apis/filesystem/FileEntry); nor do the individual properties, methods, and events of those objects belong. We've been reasonably successful keeping the topic clusters succinct and meaningful for the APIs. Also, tutorial and concept pages fit into the current implementation the way they should. But for the CSS pages, things are getting out of control. 

==Problems==

* Too many pages being assigned to the same cluster resulting in overly-long lists of links. 
** [[css/selectors/attributes/whitespace#Related_articles]] (An example of a really long list under Selectors.)
** [[css/properties/display#Related_articles]] (The text topic cluster is so long as to be useless.)
* The list of [[Property:Topic_Cluster]] items is getting very long and unwieldy.
* Duplicate pages in topic clusters, and duplicate topic clusters. Examples:
** [[css/properties/font-family#Related_articles]] (Note CSS Fonts and Fonts)
* There are two basic use cases for topic clusters:
** To group pages of the same type, i.e. css/border-style, css/border-right-style, css/border-left-style, etc. (This is more of a navigation use case.)
** To provide a mix of reference, conceptual, and tutorial articles of the same topic. (This is more true to the intent of topic clusters.)
: Our current implementation does not differentiate between these two use cases, resulting in lists that are a mix of both.

One of the hurdles is the lack of listing pages for groups of CSS properties and the flat structure of the css/ namespace. If we had listing pages for groups of CSS properties, we could reduce the length of the topic cluster lists generated by simply assigning only the CSS property listing pages (for example, a css/border page, which would be the listing page for css/border/border-style, css/border/border-right-style, etc.)

==Objectives==

===Categorization===

We'd like ''sub''-topic clusters to provide a categorization layer over the CSS properties. For example, we would create sub-topic clusters for each of the topic clusters in column three of the [[Meta:web_platform_wednesday|WPW page]]. But these would be distinct from the existing topic clusters, which we'll keep (and clean up, of course).

These sub-topic clusters could be used in a navigation structure, like the way SitePoint does it. Notice how in the navigation pane, the [http://reference.sitepoint.com/css/height height] property page is a child of Dimensions, and Dimensions is a child of Box Properties, yet the URL still reads, "css/height." No listing pages exist for either the Dimensions or Box Properties interstitials. They are only nodes in the navigation tree.

However, building out a navigation UI and all that is beyond the scope of this proposal. Here we're concerned with building just the infrastructure with templates and properties to enable the sub-topic clusters. For this project, the sub-topic clusters would function and display the same way the current topic clusters do.

As a mechanism, we need to make this extensible so we can implement it for not just CSS properties, but other sections of WPD that are mostly flat, like the other CSS namespaces, HTML, and so forth.

===Membership in multiple sub-topic clusters===

A given page could belong to more that one sub-topic cluster. Indeed, this is one way to provide a multi-faceted taxonomy. For example, the CSS border-right-style property could belong to both the "Border Right" and "Border Style" sub-topic clusters.

===Union with topic clusters===

However, even if we solve the categorization problem, per the above, we still need to solve for the union of sub-topic clusters with topic clusters. Instead of including every CSS page (topic) for a group of properties in a topic cluster, we would like to include just the sub-topic cluster for that group. For example, in a "Responsive Design" topic cluster, we would like to include articles on device detection, CSS media queries, the viewport meta tag, the FullScreen API, and the FlexBox CSS properties. But we don't want to include a link to every FlexBox property. Rather, we would like to include a link to the "Flexbox" sub-topic cluster.

This, of course, is impossible unless there is a ''page'' for the "Flexbox" sub-topic cluster, which there is not; it exists only as a property shared by a group of pages.

If we want to reduce the size of the topic cluster list by aggregating groups of CSS properties (or other flat content), we have to create listing pages for those groups of properties. The listing pages would function the same way as they do for API pages.

The disadvantage: there goes our flat URL structure. Instead of css/border-right-style we would have something like css/border_style/border-right-style, where the border_style page would be a listing page with border-style, border-right-style, border-left-style, border-bottom-style, and border-bottom-style as member pages.

But at least the "CSS Layout" topic cluster would be able to refer to just the border_style listing page, instead of including links to all of the other border-style pages.

==Design==

Currently, topic clusters work like this:

The Topic Cluster pane gets generated in the [[Template:See_Also_Section]]:
<pre>
<includeonly>{{#if: {{{Topic_clusters|}}}{{{Manual_links|}}}{{{External_links|}}}{{{Manual_sections|}}}|
==See also==
{{#if: {{{Topic_clusters|}}}|
</pre>

by the following [[Template:See_Also_Form_Section]] code:
<pre>
==See also section==
Most of this section is auto-generated by assigning an article to a topic cluster. Only use Manual links rarely; instead add a new topic cluster to [[Property:Topic_Cluster]]
{| class="formtable"
! Topic clusters: 
| <nowiki>{{{field|Topic_clusters|property=Topic_Cluster|list}}}</nowiki>
|-
</pre>
This draws the checkboxes for the topic clusters with the values from the [[Property:Topic_Cluster]].

Then the list of links are produced in the published page with the following template call:
<pre>
{{See_Also_Section
|Topic_clusters=Selectors
}}
</pre>

In the above, "Selectors" is the only topic cluster cited; there could be others.

The sub-topic clusters would be implemented as follows. 

First, the form needs a new section for the sub-topic cluster that pertains to this page. The "#if" condition would provide the proper type of sub-topic cluster. For example, the template would provide for the Sub-topic_Cluster_CSS_Property, Sub-topic_Cluster_CSS_Selector, and Sub-topic_Cluster_HTML_Element to be displayed. There could be sub-topic clusters for each page type.

<pre>
<includeonly>{{#if: {{{Topic_clusters|}}}{{{Sub-topic_Cluster_CSS_Property|}}}{{{Sub-topic_Cluster_CSS_Selector|}}}{{{Sub-topic_Cluster_HTML_Element|}}}{{{Manual_links|}}}{{{External_links|}}}{{{Manual_sections|}}}|
==See also==
{{#if: {{{Topic_clusters|}}}|
{{#if: Sub-topic_Cluster_CSS_Property|}}|
{{#if: Sub-topic_Cluster_CSS_Selector|}}|
{{#if: Sub-topic_Cluster_HTML_Element|}}|
</pre>

But now here's the tricky part. The [[Template:See_Also_Form_Section]] code needs to provide a switch so that the sub-topic cluster choices provided pertain to the page. I've added this aspect as pseudo code, prefixed with '###' below:
<pre>
==See also section==
Most of this section is auto-generated by assigning an article to a topic cluster. Only use Manual links rarely; instead add a new topic cluster to [[Property:Topic_Cluster]]
{| class="formtable"
! Topic clusters: 
| <nowiki>{{{field|Topic_clusters|property=Topic_Cluster|list}}}</nowiki>
|-
### if this is a CSS_Property page
[[Property:Sub-topic_Cluster_CSS_Property]]
{| class="formtable"
! Related CSS Properties: 
| <nowiki>{{{field|Sub-topic_clusters|property=Sub-topic_Cluster_CSS_Property|list}}}</nowiki>
|-
### if this is a CSS_Selector page
[[Property:Sub-topic_Cluster_CSS_Selector]]
{| class="formtable"
! Related CSS Selectors: 
| <nowiki>{{{field|Sub-topic_clusters|property=Sub-topic_Cluster_CSS_Selectors|list}}}</nowiki>
|-
### if this is an HTML_Element page
[[Property:Sub-topic_Cluster_ HTML_Element]
{| class="formtable"
! Related  HTML Elements: 
| <nowiki>{{{field|Sub-topic_clusters|property=Sub-topic_Cluster_ HTML_Element|list}}}</nowiki>
|-
</pre>

The above is based on a shaky understanding of how these things work, and I'm hoping for help from the Template Corps to flesh this idea out with a more cogent explanation.